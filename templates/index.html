<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>42 Amman Bot - Neubrutalism Style</title>
			<style>
			:root
			{
				--primary-color: #FF6B6B;
				--secondary-color: #4ECDC4;
				--accent-color: #FFE66D;
				--dark-color: #292F36;
				--light-color: #F7FFF7;
				--shadow-offset: 5px;
			}

			body
			{
				font-family: 'Courier New', monospace;
				background-color: #F7FFF7;
				margin: 0;
				padding: 0;
				display: flex;
				flex-direction: column;
				align-items: center;
				height: 100vh;
				color: var(--dark-color);
			}

			h1
			{
				margin-top: 20px;
				font-size: 2.5rem;
				font-weight: 900;
				text-transform: uppercase;
				letter-spacing: -1px;
				color: var(--dark-color);
				border-bottom: 4px solid var(--primary-color);
				padding-bottom: 5px;
			}

			#chatbox
			{
				width: 90%;
				max-width: 700px;
				background: white;
				border: 3px solid var(--dark-color);
				border-radius: 0px;
				box-shadow: var(--shadow-offset) var(--shadow-offset) 0 var(--dark-color);
				padding: 20px;
				margin: 20px 0;
				overflow-y: auto;
				flex-grow: 1;
			}

			.message 
			{
				padding: 12px 16px;
				margin: 15px 0;
				border: 2px solid var(--dark-color);
				border-radius: 0px;
				max-width: 85%;
				font-weight: 600;
				animation: popIn 0.3s ease-out;
			}

			.user
			{
				background-color: var(--accent-color);
				align-self: flex-end;
				margin-left: auto;
				box-shadow: 4px 4px 0 var(--dark-color);
			}

			.bot
			{
				background-color: var(--secondary-color);
				align-self: flex-start;
				margin-right: auto;
				box-shadow: 4px 4px 0 var(--dark-color);
				color: var(--dark-color);
			}

			#inputArea
			{
				display: flex;
				justify-content: center;
				width: 90%;
				max-width: 700px;
				margin-bottom: 30px;
			}

			#userInput
			{
				flex-grow: 1;
				padding: 15px;
				border: 3px solid var(--dark-color);
				border-radius: 0px;
				font-size: 16px;
				font-family: 'Courier New', monospace;
				font-weight: 600;
				box-shadow: 3px 3px 0 var(--dark-color);
			}

			#userInput:focus
			{
				outline: none;
				border-color: var(--primary-color);
			}

			button
			{
				padding: 15px 25px;
				margin-left: 10px;
				background-color: var(--primary-color);
				color: var(--dark-color);
				border: 3px solid var(--dark-color);
				border-radius: 0px;
				cursor: pointer;
				font-weight: 800;
				text-transform: uppercase;
				font-family: 'Courier New', monospace;
				box-shadow: 5px 5px 0 var(--dark-color);
				transition: all 0.1s ease;
			}

			button:hover
			{
				transform: translate(-2px, -2px);
				box-shadow: 7px 7px 0 var(--dark-color);
			}

			button:active
			{
				transform: translate(3px, 3px);
				box-shadow: 2px 2px 0 var(--dark-color);
			}

			.skeleton
			{
				background-color: #eee;
				border: 2px solid var(--dark-color);
				height: 20px;
				margin: 15px 0;
				width: 70%;
				box-shadow: 4px 4px 0 var(--dark-color);
				position: relative;
				overflow: hidden;
			}

			.skeleton::after
			{
				content: "";
				position: absolute;
				top: 0;
				right: 0;
				bottom: 0;
				left: 0;
				background: linear-gradient(90deg, transparent, rgba(255,255,255,0.6), transparent);
				animation: shimmer 1.5s infinite;
			}

			.logo
			{
				font-size: 1.2rem;
				margin-top: 15px;
				font-weight: 800;
				color: var(--primary-color);
				text-transform: uppercase;
				letter-spacing: 2px;
			}

			@keyframes shimmer
			{
				0% { transform: translateX(-100%); }
				100% { transform: translateX(100%); }
			}

			@keyframes popIn
			{
				0% { opacity: 0; transform: scale(0.8); }
				50% { transform: scale(1.05); }
				100% { opacity: 1; transform: scale(1); }
			}

			.decoration
			{
				position: absolute;
				z-index: -1;
			}

			.circle
			{
				width: 100px;
				height: 100px;
				border-radius: 50%;
				background-color: var(--accent-color);
				border: 3px solid var(--dark-color);
				top: 20%;
				left: 15%;
			}

			.square
			{
				width: 70px;
				height: 70px;
				background-color: var(--secondary-color);
				border: 3px solid var(--dark-color);
				bottom: 15%;
				right: 15%;
			}

			.zigzag
			{
				width: 150px;
				height: 30px;
				background: repeating-linear-gradient(
				45deg,
				var(--primary-color),
				var(--primary-color) 10px,
				transparent 10px,
				transparent 20px
				);
				border: 3px solid var(--dark-color);
				top: 10%;
				right: 20%;
			}
			</style>
		</head>
	<body>
	<div class="decoration circle"></div>
	<div class="decoration square"></div>
	<div class="decoration zigzag"></div>

	<h1>42 AMMAN BOT</h1>
	<div class="logo">Your coding companion</div>

	<div id="chatbox"></div>

	<div id="inputArea">
	<input id="userInput" placeholder="Ask about 42 Amman..." />
	<button onclick="askBot()">ASK</button>
	</div>

	<script>
	const chatbox = document.getElementById('chatbox');

	function saveHistory(history)
	{
		return;
	}

	function loadHistory()
	{
		return [];
	}

	function appendMessage(text, sender) {
		const div = document.createElement('div');
		div.className = `message ${sender}`;
		div.textContent = text;
		chatbox.appendChild(div);
		chatbox.scrollTop = chatbox.scrollHeight;
	}

	function appendSkeleton() {
		const skeleton = document.createElement('div');
		skeleton.className = 'skeleton';
		skeleton.id = 'skeleton-loader';
		chatbox.appendChild(skeleton);
		chatbox.scrollTop = chatbox.scrollHeight;
	}

	function removeSkeleton() {
		const skeleton = document.getElementById('skeleton-loader');
		if (skeleton) skeleton.remove();
	}

	let chatHistory = loadHistory();

	document.getElementById('userInput').addEventListener('keydown', function (e) {
		if (e.key === 'Enter') askBot();
	});

	async function askBot()
	{
		const input = document.getElementById('userInput');
		const question = input.value.trim();
		if (!question) return;
		appendMessage(question, 'user');
		chatHistory.push({ text: question, sender: 'user' });
		input.value = '';
		appendSkeleton();
		try
		{
		const res = await fetch('/ask', {
			method: 'POST',
			headers: { 'Content-Type': 'application/json' },
			body: JSON.stringify({ prompt: question })
		});
		const data = await res.json();
		removeSkeleton();
		const answer = data.generated_text || data.answer || data.error || "No response.";
		appendMessage(answer, 'bot');
		chatHistory.push({ text: answer, sender: 'bot' });
		saveHistory(chatHistory);
		}
		catch (err)
		{
		removeSkeleton();
		const errorMsg = "Something went wrong. Try again later!";
		appendMessage(errorMsg, 'bot');
		chatHistory.push({ text: errorMsg, sender: 'bot' });
		saveHistory(chatHistory);
		}
	}
	window.onload = function()
	{
		if (chatHistory.length === 0)
		{
		setTimeout(() =>
		{
			appendMessage("Hi there! I'm the 42 Amman Bot. Ask me anything about 42 Amman programming school!", 'bot');
			chatHistory.push({ text: "Hi there! I'm the 42 Amman Bot. Ask me anything about 42 Amman programming school!", sender: 'bot' });
			saveHistory(chatHistory);
		}, 500);
		}
	};
	</script>
	</body>
</html>